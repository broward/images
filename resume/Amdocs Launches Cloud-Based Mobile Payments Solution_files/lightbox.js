define(['jquery','lg-share','lg-thumbnail','lg-zoom','lg-video','lightbox'],function($){var $lg=$('.gallery');var $logo=$('.release-header');var isTouch='ontouchstart'in window||navigator.msMaxTouchPoints;var fbId='1437737463153499';var initKaltura;$logo.lightGallery({selector:'.logo',share:true,fbAppId:fbId,googlePlus:false,closable:false,zoom:false,download:true});$lg.lightGallery({selector:'.lightbox-item',share:true,fbAppId:fbId,googlePlus:false,thumnail:true,controls:isTouch?false:true,pullCaptionUp:false,showThumbByDefault:false,hideBarsDelay:1500,closable:false,download:true});$logo.on('onBeforeOpen.lg',function(){$('.btn-fab').addClass('hide').removeClass('visible-xs');});$lg.on('onBeforeOpen.lg',function(){$('.btn-fab').addClass('hide').removeClass('visible-xs');});$logo.on('onCloseAfter.lg',function(){$('.btn-fab').removeClass('hide').addClass('visible-xs');var lastFocuslogo=document.querySelector('.tablogofocus');lastFocuslogo.focus();});$lg.on('onCloseAfter.lg',function(){$('.btn-fab').removeClass('hide').addClass('visible-xs');var lastFocus=document.querySelector('.tabfocus');lastFocus.focus();});$('.release-header, .gallery').on('onAfterAppendSubHtml.lg',function(){var lgImage=$('.lg-download').attr('href');$('.lg-download').attr('href',lgImage).attr('download',lgImage);document.getElementById("lightboxFocus").focus();});$lg.on('onAfterAppendSubHtml.lg',function(e,i){document.getElementById("lightboxFocus").focus();focusablelemets='iframe, button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';gallerypopup=document.querySelector('#lightboxFocus');focusableContent=gallerypopup.querySelectorAll(focusablelemets);firstfocusablecontent=focusableContent[0];lastfocusablecontent=focusableContent[focusableContent.length-1];document.addEventListener('keydown',function(e){let isTabPressed=e.key==='Tab'||e.keyCode===9;if(!isTabPressed){return;}
if(e.shiftKey){if(document.activeElement===firstfocusablecontent){lastfocusablecontent.focus();e.preventDefault();}}else{if(document.activeElement===lastfocusablecontent){firstfocusablecontent.focus();videoele=document.querySelector(".mwEmbedKalturaIframe");if(videoele){document.getElementById("lightboxFocus").focus();}
e.preventDefault();}}});var audio=$('.lg-item.lg-current').find('.lg-audio');if(audio.length>0){audio.get(0).play();}
var youtube=$('.lg-item.lg-current').find('.lg-youtube').get(0);if(youtube){youtube.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*");}
setTimeout(function(){var kaltura=$('.lg-item.lg-current').find('.lg-kaltura');if(kaltura.length>0){if(require.defined('lightbox-kaltura')){initKaltura(i);}else{require(["lightbox-kaltura"],function(init){initKaltura=init;initKaltura(i)});}}},500);});$lg.on('onBeforeClose.lg',function(){var kalturaPlayers=$('.kWidgetIframeContainer');$.each(kalturaPlayers,function(i,v){kWidget.destroy($(v).attr('id'));})});$lg.on('onAfterAppendSubHtml.lg',function(e,i){var $items=$('.gallery .lightbox-item');var $thisItem=$items.eq(i);if($thisItem.hasClass('video')||$thisItem.hasClass('audio')){if($thisItem.hasClass('kaltura')===false&&$thisItem.hasClass('audio')===false){var youTubeUrl=$thisItem.attr('data-facebook-share-url');$('#lg-share').unbind('click.facebook').one('click.facebook',function(){var newHref='https://www.facebook.com/sharer/sharer.php?u='+youTubeUrl+'&appId='+fbId;$('#lg-share-facebook').attr('href',newHref);});}
$('#lg-share').unbind('click.pinterest').one('click.pinterest',function(){$('#lg-share-pinterest').hide();});}else{$('#lg-share').unbind('click.pinterest')
$('#lg-share').unbind('click.facebook');$('#lg-share-pinterest').show();}});$(document).on('click.bs.dropdown.data-api','.lg-dropdown',function(e){e.stopPropagation();});$logo.on('onAfterAppendSubHtml.lg',function(e,i){document.getElementById("lightboxFocus").focus();logofocusableele='video, button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])';gallerylogofocus=document.querySelector('#lightboxFocus');logofocusableContent=gallerylogofocus.querySelectorAll(logofocusableele);logofirstFocusable=logofocusableContent[0];logolastFocusable=logofocusableContent[logofocusableContent.length-1];document.addEventListener('keydown',function(e){let isTabPressed=e.key==='Tab'||e.keyCode===9;if(!isTabPressed){return;}
if(e.shiftKey){if(document.activeElement===logofirstFocusable){logolastFocusable.focus();e.preventDefault();}}else{if(document.activeElement===logolastFocusable){logofirstFocusable.focus();e.preventDefault();}}});logofirstFocusable.focus();});});